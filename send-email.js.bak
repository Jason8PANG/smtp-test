// send-email.js
const nodemailer = require('nodemailer');

// === é…ç½®ä½ çš„ SMTP ä¿¡æ¯ ===
const smtpConfig = {
  host: 'smtp.nai-group.com',           // SMTP æœåŠ¡å™¨åœ°å€ï¼Œå¦‚ï¼šsmtp.163.comã€smtp.gmail.com
  port: 25,                     // ç«¯å£ï¼š465ï¼ˆSSLï¼‰æˆ– 587ï¼ˆSTARTTLSï¼‰
  secure: false,                  // true for 465, false for other ports
  ignoreTLS: true

};

// åˆ›å»ºä¼ è¾“å™¨
const transporter = nodemailer.createTransport(smtpConfig);

// é‚®ä»¶å†…å®¹
const mailOptions = {
  from: 'jason.pang@nai-group.com',           // å‘ä»¶äºº
  to: 'jason.pang@nai-group.com',                      // æ”¶ä»¶äººï¼ˆæ›¿æ¢ä¸ºä½ çš„æµ‹è¯•é‚®ç®±ï¼‰
  subject: 'SMTP test email âœ”',                      // ä¸»é¢˜
  text: 'è¿™æ˜¯ä¸€å°é€šè¿‡ Node.js SMTP å‘é€çš„æµ‹è¯•é‚®ä»¶ï¼', // çº¯æ–‡æœ¬å†…å®¹
  html: '<b>è¿™æ˜¯ä¸€å°é€šè¿‡ Node.js SMTP å‘é€çš„æµ‹è¯•é‚®ä»¶ï¼</b><p>å¦‚æœçœ‹åˆ°æ­¤å†…å®¹ï¼Œè¯´æ˜ SMTP é…ç½®æˆåŠŸï¼ğŸ‰</p>' // HTML å†…å®¹
};

// å‘é€é‚®ä»¶
async function sendEmail() {
  try {
    const info = await transporter.sendMail(mailOptions);
    console.log('âœ… Email Send Successfully');
    console.log('Message ID:', info.messageId);
    console.log('Preview URL:', nodemailer.getTestMessageUrl(info)); // ä»…å¯¹æŸäº›æœåŠ¡æœ‰æ•ˆ
  } catch (error) {
    console.error('âŒ Email Delivery Failed');
    console.error('error code:', error.code);
    console.error('error message:', error.message);
    if (error.response) {
      console.error('error response:', error.response);
    }
  }
}

// æ‰§è¡Œå‘é€
sendEmail();